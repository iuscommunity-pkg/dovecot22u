Q. We used to use University of Washington IMAP (UW IMAP), in the Red
   Hat distribution, the rpm was named "imap". We would now like to use
   dovecot and take advantage of its support for Maildir format, but
   we have existing user mail files in the old mbox format we need to
   migrate. How can we do this?

A. Read the documentation in
   /usr/share/doc/dovecot-*/UW-to-Dovecot-Migration. You will also
   find scripts there to help you.

Q. I'm getting errors in /var/log/maillog for dotlock failed,
   permission denied. The actual error probably looks like this with
   user replaced by a user name on your system.

   imap(user): file_lock_dotlock() failed with mbox file /var/spool/mail/user: Permission denied

A. This is occuring because:

   1) The user INBOX is in the system spool directory which is:
      "drwxrwxr-x root mail"

   2) Dovecot is configured to create "dotlock" locking files.

   3) After an imap user logs in the imap process runs as that user
      and the spool directory permissions does not allow that user to
      creat new files (e.g. dot lock files).

   The possible solutions are:

   1) Don't locate the user's INBOX in the system spool directory,
      have mail delivered to another location, for instance his home
      directory (this may not be possible to change for existing
      systems). This is an MTA configuration.

   2) In the dovecot configuration file set the variable
      mail_extra_groups to "mail". This will add the mail group to the
      list of groups that the logged in imap user will have permission
      for. His imap process can then create files in the mail spool
      file. However the user's imap process now has mail group
      privileges, you will have to evaluate the extent of the security
      threat this poses for your site.

   3) Disable the use of dotlocks by setting dovecots config parameter
      mbox_locks to a value that does not include dotlock, for
      example, fcntl. However, note dotlocks are considered robust,
      especially for NFS.
